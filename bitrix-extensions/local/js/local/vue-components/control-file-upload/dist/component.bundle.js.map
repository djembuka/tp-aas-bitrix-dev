{"version":3,"file":"component.bundle.js","sources":["../src/component.js"],"sourcesContent":["import './component.css';\r\n\r\nexport const ControlFileUpload = {\r\n  data() {\r\n    return {\r\n      controlId: this.id || this.control.id || null,\r\n      controlName: this.name || this.control.name || null,\r\n      focused: false,\r\n      blured: false,\r\n      warning: '',\r\n      hint: this.control.hint_external,\r\n\r\n      minimalLoading: false,\r\n      loading: false,\r\n      loadCircle: false,\r\n      percentage: 0, //%\r\n      isFileLoaded: false,\r\n      xhrStatus: '', //'Y', 'E'\r\n      active: true,\r\n      files: [],\r\n      default: '<a href=\"\">Выберите файл</a>&nbsp;или перетащите в поле',\r\n      required: this.control.required,\r\n      icon: `<g transform=\"translate(-4.461)\">\r\n          <g transform=\"translate(4.461)\">\r\n            <g>\r\n              <path d=\"M21.844,6.573v15.88A1.547,1.547,0,0,1,20.3,24H6.008a1.546,1.546,0,0,1-1.547-1.547V1.547A1.546,1.546,0,0,1,6.008,0H15.27Z\" transform=\"translate(-4.461)\" class=\"a\"/>\r\n            </g>\r\n            <path d=\"M20.036,8.289l5.677,2.339v-2.2l-3.218-.951Z\" transform=\"translate(-8.33 -1.858)\" class=\"b\"/>\r\n            <path d=\"M25.416,6.573H20.389a1.546,1.546,0,0,1-1.547-1.547V0Z\" transform=\"translate(-8.033)\" class=\"c\"/>\r\n          </g>\r\n          <path d=\"M18.117,19.012l-2.85-2.85a.555.555,0,0,0-.785,0l-2.85,2.85a.555.555,0,0,0,.785.784l1.9-1.9v5.024a.555.555,0,1,0,1.109,0V17.894l1.9,1.9a.555.555,0,0,0,.785-.784Z\" transform=\"translate(-1.741 -3.974)\" class=\"d\"/>\r\n        </g>`,\r\n    };\r\n  },\r\n  props: ['control', 'id', 'name'],\r\n  // language=Vue\r\n  template: `\r\n\t\t<div\r\n      :class=\"{\r\n        'twpx-form-control': true,\r\n        'twpx-form-control--file': true,\r\n        'twpx-form-control--active': active,\r\n        'twpx-form-control--invalid': invalid,\r\n        'twpx-form-control--disabled': disabled,\r\n      }\"\r\n    >\r\n      <img\r\n        :src=\"disabled\"\r\n        class=\"twpx-form-control__file__disabled-icon\"\r\n        v-if=\"false\"\r\n      />\r\n      <span\r\n        class=\"twpx-form-control__file__clear\" :class=\"{'btn--load-circle': loadCircle}\"\r\n        @click.prevent=\"clearInputFile\"\r\n        v-if=\"isClearable\"\r\n      ></span>\r\n      <div\r\n        class=\"twpx-form-control__file\"\r\n        :class=\"{\r\n          filled: isFilled,\r\n          clearable: isClearable,\r\n          progressing: isProgressing,\r\n        }\"\r\n        ref=\"controlFile\"\r\n      >\r\n        <span class=\"twpx-form-control__file__label\">{{ control.label }}</span>\r\n\r\n        <svg\r\n          xmlns=\"http://www.w3.org/2000/svg\"\r\n          width=\"17.383\"\r\n          height=\"24\"\r\n          viewBox=\"0 0 17.383 24\"\r\n          v-html=\"icon\"\r\n        ></svg>\r\n\r\n        <input\r\n          type=\"file\"\r\n          :name=\"control.name\"\r\n          :id=\"control.id\"\r\n          @change=\"uploadFile($refs.inputFile.files)\"\r\n          ref=\"inputFile\"\r\n        />\r\n\r\n        <div class=\"twpx-form-control__file__progressbar\" v-show=\"(isProgressing || loadCircle) && !isInvalid\" ref=\"progressbar\" :class=\"{'minimal': minimalLoading}\">\r\n          <span v-html=\"label\" v-show=\"isFileLoaded\"></span>\r\n          <span v-show=\"!isFileLoaded\">{{percentage}}%</span>\r\n        </div>\r\n\r\n        <label\r\n          :for=\"control.id\"\r\n          class=\"active\"\r\n          v-html=\"label\"\r\n          ref=\"dropzone\"\r\n        ></label>\r\n      </div>\r\n      <div class=\"twpx-form-control__hint\" v-html=\"hint\" v-if=\"hint\"></div>\r\n    </div>\r\n\t`,\r\n  emits: ['input', 'focus', 'blur', 'enter'],\r\n  computed: {\r\n    progress() {\r\n      return this.control.upload.progress || {};\r\n    },\r\n    response() {\r\n      return this.control.upload.response || {};\r\n    },\r\n    readyState() {\r\n      return this.control.upload.readyState;\r\n    },\r\n    placeholder() {\r\n      if (this.focused && !this.value.trim()) {\r\n        return this.control.hint_internal;\r\n      } else {\r\n        return '';\r\n      }\r\n    },\r\n    active() {\r\n      return this.focused || !!this.control.value.trim();\r\n    },\r\n    invalid() {\r\n      return this.blured && !this.validate();\r\n    },\r\n    disabled() {\r\n      return this.control.disabled;\r\n    },\r\n    validateWatcher() {\r\n      return this.control.validateWatcher;\r\n    },\r\n    focusWatcher() {\r\n      return this.control.focusWatcher;\r\n    },\r\n    isInvalid() {\r\n      return !!this.invalidString;\r\n    },\r\n    isProgressing() {\r\n      return this.loading;\r\n    },\r\n    isClearable() {\r\n      return this.loadCircle || (!!this.filename && !this.isProgressing);\r\n    },\r\n    isFilled() {\r\n      return (\r\n        !!this.filename &&\r\n        this.control.upload.readyState === 4 &&\r\n        !this.isProgressing\r\n      );\r\n    },\r\n    fileid() {\r\n      return this.control.value;\r\n    },\r\n    invalidString() {\r\n      console.log('inv');\r\n      if (this.control.upload && this.control.upload.xhrStatus === 'E') {\r\n        return 'Ошибка загрузки';\r\n      } else if (this.files[0] && this.files[0].size && this.files[0].name) {\r\n        if (this.files[0].size >= this.control.maxSize) {\r\n          this.files = [];\r\n          return `Размер файла превышает ${this.formatSize(\r\n            this.control.maxSize\r\n          )}`;\r\n        }\r\n\r\n        const filename = this.files[0].name;\r\n        const lastIndex = filename.lastIndexOf('.');\r\n        const regExp = new RegExp(this.control.accept.join('|'));\r\n\r\n        if (!regExp.test(filename.substring(lastIndex + 1).toLowerCase())) {\r\n          this.files = [];\r\n          return `Прикладывайте файлы ${this.control.accept\r\n            .map((w) => w.toUpperCase())\r\n            .join(', ')}.`;\r\n        }\r\n      }\r\n      return '';\r\n    },\r\n    label() {\r\n      if (this.isProgressing) {\r\n        return '';\r\n      }\r\n      if (this.isInvalid) {\r\n        return this.invalidString;\r\n      }\r\n      if (this.files[0] && this.files[0].name) {\r\n        return this.files[0].name;\r\n      }\r\n      return this.default;\r\n    },\r\n    filename() {\r\n      return this.control.value ? this.control.value.name : '';\r\n    },\r\n  },\r\n  watch: {\r\n    progress() {\r\n      this.progressAnimation();\r\n    },\r\n    response() {\r\n      this.onResponse();\r\n    },\r\n    percentage(val) {\r\n      setTimeout(() => {\r\n        if (val === 100) {\r\n          this.isFileLoaded = true;\r\n        } else if (val === 0) {\r\n          this.isFileLoaded = false;\r\n        }\r\n      }, 600);\r\n    },\r\n    validateWatcher() {\r\n      this.blured = true;\r\n    },\r\n    focusWatcher() {\r\n      this.$refs.input.focus();\r\n    },\r\n  },\r\n  methods: {\r\n    uploadFile(files) {\r\n      this.files = files;\r\n      // this.xhrStatus = '';\r\n      this.percentage = 0;\r\n      //invalid and label change\r\n      setTimeout(() => {\r\n        if (this.isInvalid) {\r\n          this.$refs.inputFile.value = '';\r\n        } else {\r\n          this.loading = true;\r\n          this.$emit('input', { value: files[0] });\r\n        }\r\n      }, 0);\r\n    },\r\n    onResponse() {\r\n      if (this.response.STATUS === 'success') {\r\n        setTimeout(() => {\r\n          this.$refs.inputFile.value = '';\r\n        }, 100);\r\n      }\r\n\r\n      this.$refs.progressbar.style = '';\r\n      this.percentage = 0;\r\n      this.loading = false;\r\n      this.loadCircle = false;\r\n    },\r\n    clearInputFile() {\r\n      this.loadCircle = true;\r\n      this.percentage = 0;\r\n      this.loading = false;\r\n      this.files = [];\r\n      this.$refs.inputFile.value = '';\r\n\r\n      this.$emit('input', {\r\n        value: null,\r\n      });\r\n    },\r\n    cancelEvent(e) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      return false;\r\n    },\r\n    getCoords(elem) {\r\n      let box = elem.getBoundingClientRect();\r\n\r\n      return {\r\n        top: box.top + scrollY,\r\n        left: box.left + scrollX,\r\n      };\r\n    },\r\n    formatSize(length) {\r\n      var i = 0,\r\n        type = ['б', 'Кб', 'Мб', 'Гб', 'Тб', 'Пб'];\r\n      while ((length / 1000) | 0 && i < type.length - 1) {\r\n        length /= 1000;\r\n        i++;\r\n      }\r\n      return parseInt(length) + ' ' + type[i];\r\n    },\r\n    progressAnimation() {\r\n      const { first, total, loaded } = this.progress;\r\n\r\n      if (first && loaded === total) {\r\n        //loaded too fast, show minimal animation 1s\r\n        let counter = 0,\r\n          minimalTime = 1000,\r\n          intervalId;\r\n\r\n        this.minimalLoading = true;\r\n        this.$refs.progressbar.style.width = `100%`;\r\n\r\n        intervalId = setInterval(() => {\r\n          if (++counter === 11) {\r\n            clearInterval(intervalId);\r\n            // this.dataLoaded(xhr);\r\n            this.loadCircle = false;\r\n            this.minimalLoading = false;\r\n            return;\r\n          }\r\n          this.percentage = Math.floor((counter * 100) / 10);\r\n        }, minimalTime / 10);\r\n      } else {\r\n        this.percentage = Math.floor((loaded / total) * 100);\r\n        this.$refs.progressbar.style.width = `calc(46px + (100% - 46px ) * ${this.percentage} / 100)`;\r\n        this.loadCircle = false;\r\n      }\r\n    },\r\n\r\n    focus() {\r\n      this.focused = true;\r\n      this.blured = false;\r\n      this.$emit('focus');\r\n    },\r\n    blur() {\r\n      this.focused = false;\r\n      this.blured = true;\r\n      this.$emit('blur');\r\n    },\r\n    enter() {\r\n      this.$emit('enter');\r\n    },\r\n    validate() {\r\n      if (\r\n        (this.control.required && this.value.trim()) ||\r\n        !this.control.required\r\n      ) {\r\n        if (this.control.regexp) {\r\n          const match = String(this.value.trim()).match(\r\n            RegExp(this.control.regexp)\r\n          );\r\n          if (!match) {\r\n            this.warning = this.control.regexp_description;\r\n          } else {\r\n            this.warning = '';\r\n          }\r\n          return match;\r\n        } else {\r\n          return true;\r\n        }\r\n      } else if (this.control.required && !this.value) {\r\n        return false;\r\n      }\r\n      return true;\r\n    },\r\n  },\r\n  mounted() {\r\n    //drag&drop file\r\n    const dropZone = this.$refs.dropzone;\r\n    const controlFile = this.$refs.controlFile;\r\n    if (!dropZone) {\r\n      return;\r\n    }\r\n    dropZone.addEventListener('drag', this.cancelEvent);\r\n    dropZone.addEventListener('dragstart', this.cancelEvent);\r\n    dropZone.addEventListener('dragend', this.cancelEvent);\r\n    dropZone.addEventListener('dragover', this.cancelEvent);\r\n    dropZone.addEventListener('dragenter', this.cancelEvent);\r\n    dropZone.addEventListener('dragleave', this.cancelEvent);\r\n    dropZone.addEventListener('drop', this.cancelEvent);\r\n\r\n    dropZone.addEventListener('dragover', () => {\r\n      controlFile.classList.add('dragover');\r\n    });\r\n    dropZone.addEventListener('dragenter', () => {\r\n      controlFile.classList.add('dragover');\r\n    });\r\n    dropZone.addEventListener('dragleave', (e) => {\r\n      let dx = e.pageX - this.getCoords(dropZone).left;\r\n      let dy = e.pageY - this.getCoords(dropZone).top;\r\n      if (\r\n        dx < 0 ||\r\n        dx > dropZone.clientWidth ||\r\n        dy < 0 ||\r\n        dy > dropZone.clientHeight\r\n      ) {\r\n        controlFile.classList.remove('dragover');\r\n      }\r\n    });\r\n\r\n    dropZone.addEventListener('drop', (e) => {\r\n      controlFile.classList.remove('dragover');\r\n      controlFile.classList.add('filled');\r\n      this.uploadFile(e.dataTransfer.files);\r\n    });\r\n  },\r\n};\r\n"],"names":["ControlFileUpload","data","controlId","id","control","controlName","name","focused","blured","warning","hint","hint_external","minimalLoading","loading","loadCircle","percentage","isFileLoaded","xhrStatus","active","files","required","icon","props","template","emits","computed","progress","upload","response","readyState","placeholder","value","trim","hint_internal","invalid","validate","disabled","validateWatcher","focusWatcher","isInvalid","invalidString","isProgressing","isClearable","filename","isFilled","fileid","console","log","size","maxSize","formatSize","lastIndex","lastIndexOf","regExp","RegExp","accept","join","test","substring","toLowerCase","map","w","toUpperCase","label","watch","progressAnimation","onResponse","val","setTimeout","$refs","input","focus","methods","uploadFile","inputFile","$emit","STATUS","progressbar","style","clearInputFile","cancelEvent","e","preventDefault","stopPropagation","getCoords","elem","box","getBoundingClientRect","top","scrollY","left","scrollX","length","i","type","parseInt","first","total","loaded","counter","minimalTime","intervalId","width","setInterval","clearInterval","Math","floor","blur","enter","regexp","match","String","regexp_description","mounted","dropZone","dropzone","controlFile","addEventListener","classList","add","dx","pageX","dy","pageY","clientWidth","clientHeight","remove","dataTransfer"],"mappings":"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"}