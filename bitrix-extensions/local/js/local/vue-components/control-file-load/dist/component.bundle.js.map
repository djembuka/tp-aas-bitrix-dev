{"version":3,"file":"component.bundle.js","sources":["../src/component.js"],"sourcesContent":["import './component.css';\n\nexport const ControlFileLoad = {\n  data() {\n    return {\n      controlId: this.id || this.control.id || null,\n      controlName: this.name || this.control.name || null,\n      focused: false,\n      blured: false,\n      warning: '',\n      hint: this.control.hint_external,\n\n      minimalLoading: false,\n      loading: false,\n      loadCircle: false,\n      percentage: 0, //%\n      isFileLoaded: false,\n      xhrStatus: '', //'Y', 'E'\n      active: true,\n      files: [],\n      default: '<a href=\"\">Выберите файл</a>&nbsp;или перетащите в поле',\n      required: this.control.required,\n      icon: `<g transform=\"translate(-4.461)\">\n          <g transform=\"translate(4.461)\">\n            <g>\n              <path d=\"M21.844,6.573v15.88A1.547,1.547,0,0,1,20.3,24H6.008a1.546,1.546,0,0,1-1.547-1.547V1.547A1.546,1.546,0,0,1,6.008,0H15.27Z\" transform=\"translate(-4.461)\" class=\"a\"/>\n            </g>\n            <path d=\"M20.036,8.289l5.677,2.339v-2.2l-3.218-.951Z\" transform=\"translate(-8.33 -1.858)\" class=\"b\"/>\n            <path d=\"M25.416,6.573H20.389a1.546,1.546,0,0,1-1.547-1.547V0Z\" transform=\"translate(-8.033)\" class=\"c\"/>\n          </g>\n          <path d=\"M18.117,19.012l-2.85-2.85a.555.555,0,0,0-.785,0l-2.85,2.85a.555.555,0,0,0,.785.784l1.9-1.9v5.024a.555.555,0,1,0,1.109,0V17.894l1.9,1.9a.555.555,0,0,0,.785-.784Z\" transform=\"translate(-1.741 -3.974)\" class=\"d\"/>\n        </g>`,\n    };\n  },\n  props: ['control', 'id', 'name'],\n  // language=Vue\n  template: `\n\t\t<div\n      :class=\"{\n        'twpx-form-control': true,\n        'twpx-form-control--file': true,\n        'twpx-form-control--active': active,\n        'twpx-form-control--invalid': invalid,\n        'twpx-form-control--disabled': disabled,\n      }\"\n    >\n      <img\n        :src=\"disabled\"\n        class=\"twpx-form-control__file__disabled-icon\"\n        v-if=\"false\"\n      />\n      <span\n        class=\"twpx-form-control__file__clear\"\n        @click.prevent=\"clearInputFile\"\n        v-if=\"isClearable\"\n      ></span>\n      <div\n        class=\"twpx-form-control__file\"\n        :class=\"{\n          filled: isFilled,\n          clearable: isClearable,\n        }\"\n        ref=\"controlFile\"\n      >\n        <span class=\"twpx-form-control__file__label\">{{ control.label }}</span>\n\n        <svg\n          xmlns=\"http://www.w3.org/2000/svg\"\n          width=\"17.383\"\n          height=\"24\"\n          viewBox=\"0 0 17.383 24\"\n          v-html=\"icon\"\n        ></svg>\n\n        <input\n          type=\"file\"\n          :name=\"control.name\"\n          :id=\"control.id\"\n          @change=\"uploadFile($refs.inputFile.files)\"\n          ref=\"inputFile\"\n        />\n\n        <div class=\"twpx-form-control__file__progressbar\" v-show=\"(isProgressing || loadCircle) && !isInvalid\" ref=\"progressbar\" :class=\"{'minimal': minimalLoading}\">\n          <span v-html=\"label\" v-show=\"isFileLoaded\"></span>\n          <span v-show=\"!isFileLoaded\">{{percentage}}%</span>\n        </div>\n\n        <label\n          :for=\"control.id\"\n          class=\"active\"\n          v-html=\"label\"\n          ref=\"dropzone\"\n        ></label>\n      </div>\n      <div class=\"twpx-form-control__hint\" v-html=\"hint\" v-if=\"hint\"></div>\n    </div>\n\t`,\n  emits: ['input', 'focus', 'blur', 'enter', 'upload'],\n  computed: {\n    value: {\n      get() {\n        return this.control.value;\n      },\n      set(value) {\n        this.$emit('input', { value, file: this.files[0] });\n      },\n    },\n    placeholder() {\n      if (this.focused && !this.value.trim()) {\n        return this.control.hint_internal;\n      } else {\n        return '';\n      }\n    },\n    active() {\n      return this.focused || !!this.control.value.trim();\n    },\n    invalid() {\n      return this.blured && !this.validate();\n    },\n    disabled() {\n      return this.control.disabled;\n    },\n    validateWatcher() {\n      return this.control.validateWatcher;\n    },\n    focusWatcher() {\n      return this.control.focusWatcher;\n    },\n    isInvalid() {\n      return !!this.invalidString;\n    },\n    isProgressing() {\n      return this.loading;\n    },\n    isClearable() {\n      return this.loadCircle || (!!this.filename && !this.isProgressing);\n    },\n    isFilled() {\n      return !!this.filename;\n    },\n    fileid() {\n      return this.control.value;\n    },\n    invalidString() {\n      if (this.xhrStatus === 'E') {\n        return 'Ошибка загрузки';\n      } else if (this.files[0] && this.files[0].size && this.files[0].name) {\n        if (this.files[0].size >= this.control.maxSize) {\n          this.files = [];\n          return `Размер файла превышает ${this.formatSize(\n            this.control.maxSize\n          )}`;\n        }\n\n        const filename = this.files[0].name;\n        const lastIndex = filename.lastIndexOf('.');\n        const regExp = new RegExp(this.control.accept.join('|'));\n\n        if (!regExp.test(filename.substring(lastIndex + 1).toLowerCase())) {\n          this.files = [];\n          return `Прикладывайте файлы ${this.control.accept\n            .map((w) => w.toUpperCase())\n            .join(', ')}.`;\n        }\n      }\n      return '';\n    },\n    label() {\n      if (this.isProgressing) {\n        return '';\n      }\n      if (this.isInvalid) {\n        return this.invalidString;\n      }\n      if (this.files[0] && this.files[0].name) {\n        return this.files[0].name;\n      }\n      return this.control.default;\n    },\n    filename() {\n      return this.control.filename;\n    },\n  },\n  watch: {\n    percentage(val) {\n      setTimeout(() => {\n        if (val === 100) {\n          this.isFileLoaded = true;\n        } else if (val === 0) {\n          this.isFileLoaded = false;\n        }\n      }, 600);\n    },\n    validateWatcher() {\n      this.blured = true;\n    },\n    focusWatcher() {\n      this.$refs.input.focus();\n    },\n  },\n  methods: {\n    uploadFile(files) {\n      this.$emit('input', {\n        control: this.control,\n        value: '', //file name\n        file: files[0],\n      });\n\n      this.files = files;\n      this.xhrStatus = '';\n      this.percentage = 0;\n      //invalid and label change\n      setTimeout(() => {\n        if (this.isInvalid) {\n          this.$refs.inputFile.value = '';\n        } else {\n          let formData = new FormData();\n          console.log(files[0]);\n          formData.append('FILES', files[0]);\n          formData.append('FILEID', this.fileid);\n\n          this.loading = true;\n          this.$emit('upload', { formData });\n        }\n      }, 0);\n    },\n    clearInputFile() {\n      this.loadCircle = true;\n      this.percentage = 0;\n      this.loading = false;\n      this.files = [];\n      this.$refs.inputFile.value = '';\n      this.sendData({\n        [this.name]: 'DELETE',\n        FILEID: this.fileid,\n      });\n      //set value\n      this.$emit('input', {\n        control: this.control,\n        value: '',\n        file: null,\n      });\n    },\n    cancelEvent(e) {\n      e.preventDefault();\n      e.stopPropagation();\n      return false;\n    },\n    getCoords(elem) {\n      let box = elem.getBoundingClientRect();\n\n      return {\n        top: box.top + scrollY,\n        left: box.left + scrollX,\n      };\n    },\n    formatSize(length) {\n      var i = 0,\n        type = ['б', 'Кб', 'Мб', 'Гб', 'Тб', 'Пб'];\n      while ((length / 1000) | 0 && i < type.length - 1) {\n        length /= 1000;\n        i++;\n      }\n      return parseInt(length) + ' ' + type[i];\n    },\n    progressAnimation(xhr) {\n      let first = true;\n      xhr.upload.addEventListener('progress', ({ loaded, total }) => {\n        if (first && loaded === total) {\n          //loaded too fast, show minimal animation 1s\n          let counter = 0,\n            minimalTime = 1000,\n            intervalId;\n\n          this.minimalLoading = true;\n          this.$refs.progressbar.style.width = `100%`;\n\n          intervalId = setInterval(() => {\n            if (++counter === 11) {\n              clearInterval(intervalId);\n              this.dataLoaded(xhr);\n              this.minimalLoading = false;\n              return;\n            }\n            this.percentage = Math.floor((counter * 100) / 10);\n          }, minimalTime / 10);\n        } else {\n          this.percentage = Math.floor((loaded / total) * 100);\n          this.$refs.progressbar.style.width = `calc(46px + (100% - 46px ) * ${this.percentage} / 100)`;\n          if (this.percentage === 100) {\n            this.dataLoaded(xhr);\n          }\n        }\n        first = false;\n      });\n    },\n    dataLoaded(xhr) {\n      let timeoutId;\n\n      if (xhr.readyState != 4) {\n        this.loadCircle = true;\n        timeoutId = setTimeout(() => {\n          this.dataLoaded(xhr);\n        }, 100);\n        return;\n      } else {\n        this.loadCircle = false;\n        clearTimeout(timeoutId);\n      }\n\n      const fileObject = JSON.parse(xhr.response);\n\n      if (fileObject) {\n        this.xhrStatus = fileObject.STATUS;\n\n        switch (fileObject.STATUS) {\n          case 'Y':\n            //set value\n            this.$emit('input', {\n              control: this.control,\n              value: this.files[0] ? this.files[0].name : '',\n              file: this.files[0] ? fileObject.ID : '',\n            });\n\n            setTimeout(() => {\n              this.$refs.inputFile.value = '';\n            }, 100);\n\n            break;\n\n          case 'E':\n            break;\n        }\n        this.$refs.progressbar.style = '';\n        this.percentage = 0;\n        this.loading = false;\n        this.loadCircle = false;\n      }\n      // this.$emit('timeoutAutosave');\n    },\n    focus() {\n      this.focused = true;\n      this.blured = false;\n      this.$emit('focus');\n    },\n    blur() {\n      this.focused = false;\n      this.blured = true;\n      this.$emit('blur');\n    },\n    enter() {\n      this.$emit('enter');\n    },\n    validate() {\n      if (\n        (this.control.required && this.value.trim()) ||\n        !this.control.required\n      ) {\n        if (this.control.regexp) {\n          const match = String(this.value.trim()).match(\n            RegExp(this.control.regexp)\n          );\n          if (!match) {\n            this.warning = this.control.regexp_description;\n          } else {\n            this.warning = '';\n          }\n          return match;\n        } else {\n          return true;\n        }\n      } else if (this.control.required && !this.value) {\n        return false;\n      }\n      return true;\n    },\n  },\n  mounted() {\n    //drag&drop file\n    const dropZone = this.$refs.dropzone;\n    const controlFile = this.$refs.controlFile;\n    if (!dropZone) {\n      return;\n    }\n    dropZone.addEventListener('drag', this.cancelEvent);\n    dropZone.addEventListener('dragstart', this.cancelEvent);\n    dropZone.addEventListener('dragend', this.cancelEvent);\n    dropZone.addEventListener('dragover', this.cancelEvent);\n    dropZone.addEventListener('dragenter', this.cancelEvent);\n    dropZone.addEventListener('dragleave', this.cancelEvent);\n    dropZone.addEventListener('drop', this.cancelEvent);\n\n    dropZone.addEventListener('dragover', () => {\n      controlFile.classList.add('dragover');\n    });\n    dropZone.addEventListener('dragenter', () => {\n      controlFile.classList.add('dragover');\n    });\n    dropZone.addEventListener('dragleave', (e) => {\n      let dx = e.pageX - this.getCoords(dropZone).left;\n      let dy = e.pageY - this.getCoords(dropZone).top;\n      if (\n        dx < 0 ||\n        dx > dropZone.clientWidth ||\n        dy < 0 ||\n        dy > dropZone.clientHeight\n      ) {\n        controlFile.classList.remove('dragover');\n      }\n    });\n\n    dropZone.addEventListener('drop', (e) => {\n      controlFile.classList.remove('dragover');\n      controlFile.classList.add('filled');\n      this.uploadFile(e.dataTransfer.files);\n    });\n  },\n};\n"],"names":["ControlFileLoad","data","controlId","id","control","controlName","name","focused","blured","warning","hint","hint_external","minimalLoading","loading","loadCircle","percentage","isFileLoaded","xhrStatus","active","files","required","icon","props","template","emits","computed","value","get","set","$emit","file","placeholder","trim","hint_internal","invalid","validate","disabled","validateWatcher","focusWatcher","isInvalid","invalidString","isProgressing","isClearable","filename","isFilled","fileid","size","maxSize","formatSize","lastIndex","lastIndexOf","regExp","RegExp","accept","join","test","substring","toLowerCase","map","w","toUpperCase","label","watch","val","setTimeout","$refs","input","focus","methods","uploadFile","inputFile","formData","FormData","console","log","append","clearInputFile","sendData","cancelEvent","e","preventDefault","stopPropagation","getCoords","elem","box","getBoundingClientRect","top","scrollY","left","scrollX","length","i","type","parseInt","progressAnimation","xhr","first","upload","addEventListener","loaded","total","counter","minimalTime","intervalId","progressbar","style","width","setInterval","clearInterval","dataLoaded","Math","floor","timeoutId","readyState","clearTimeout","fileObject","JSON","parse","response","STATUS","ID","blur","enter","regexp","match","String","regexp_description","mounted","dropZone","dropzone","controlFile","classList","add","dx","pageX","dy","pageY","clientWidth","clientHeight","remove","dataTransfer"],"mappings":"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"}