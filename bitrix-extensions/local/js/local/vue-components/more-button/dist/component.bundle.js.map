{"version":3,"file":"component.bundle.js","sources":["../src/component.js"],"sourcesContent":["import './component.css';\r\nimport { ButtonComponent } from 'local.vue-components.button-component';\r\n\r\nexport const MoreButton = {\r\n  data() {\r\n    return {};\r\n  },\r\n  components: {\r\n    ButtonComponent\r\n  },\r\n  props: {\r\n    text: {\r\n      type: String,\r\n      default: 'Загрузить еще'\r\n    },\r\n    loading: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    show: {\r\n      type: Boolean,\r\n      default: true\r\n    },\r\n    infiniteScroll: {\r\n      type: Object,\r\n      default: null\r\n      /*{\r\n          offset: 200,\r\n          direction: 'down',\r\n          root: null,\r\n          once: false\r\n        }*/\r\n    }\r\n  },\r\n  emits: ['clickMore'],\r\n  // language=Vue\r\n  template: `\r\n    <ButtonComponent ref=\"moreButton\" v-if=\"show\" :text=\"text\" :props=\"buttonProps\" @clickButton=\"clickButton\" />\r\n\t`,\r\n  computed: {\r\n    buttonProps() {\r\n      const result = ['serve', 'medium', 'wide'];\r\n      if (this.loading) {\r\n        result.push('load-circle');\r\n      }\r\n      return result;\r\n    }\r\n  },\r\n  methods: {\r\n    clickButton() {\r\n      this.$emit('clickMore');\r\n    },\r\n    observeProximity(target, callback, options = {}) {\r\n      const {\r\n        offset = 200,      // за сколько пикселей до элемента сработать (снизу)\r\n        root = null,       // контейнер прокрутки; null = окно\r\n        direction = 'down',// 'down' | 'up' | 'both'\r\n        threshold = 0,     // доля пересечения (обычно 0)\r\n        once = true        // вызвать один раз и отключиться\r\n      } = options;\r\n    \r\n      if (!(target instanceof Element)) {\r\n        throw new Error('observeProximity: target должен быть DOM-элементом');\r\n      }\r\n      if (typeof callback !== 'function') {\r\n        throw new Error('observeProximity: callback должен быть функцией');\r\n      }\r\n    \r\n      const top = (direction === 'up' || direction === 'both') ? offset : 0;\r\n      const bottom = (direction === 'down' || direction === 'both') ? offset : 0;\r\n    \r\n      const observer = new IntersectionObserver((entries) => {\r\n        for (const entry of entries) {\r\n          if (entry.isIntersecting) {\r\n            callback(entry);\r\n            if (once) observer.unobserve(target);\r\n          }\r\n        }\r\n      }, {\r\n        root,\r\n        rootMargin: `${top}px 0px ${bottom}px 0px`,\r\n        threshold\r\n      });\r\n    \r\n      observer.observe(target);\r\n      return () => observer.unobserve(target);\r\n    }\r\n  },\r\n  mounted() {\r\n    if (this.infiniteScroll) {\r\n      this.observeProximity(\r\n        this.$refs.moreButton.$el,\r\n        this.clickButton,\r\n        this.infiniteScroll\r\n      );\r\n    }\r\n  }\r\n};\r\n"],"names":["MoreButton","data","components","ButtonComponent","props","text","type","String","loading","Boolean","show","infiniteScroll","Object","emits","template","computed","buttonProps","result","push","methods","clickButton","$emit","observeProximity","target","callback","options","offset","root","direction","threshold","once","Element","Error","top","bottom","observer","IntersectionObserver","entries","entry","isIntersecting","unobserve","rootMargin","observe","mounted","$refs","moreButton","$el"],"mappings":";;;;;;;;AAAA,MAGaA,UAAU,GAAG;IACxBC,IAAI,kBAAG;MACL,OAAO,EAAE;KACV;IACDC,UAAU,EAAE;MACVC,eAAe,EAAfA;KACD;IACDC,KAAK,EAAE;MACLC,IAAI,EAAE;QACJC,IAAI,EAAEC,MAAM;QACZ,WAAS;OACV;MACDC,OAAO,EAAE;QACPF,IAAI,EAAEG,OAAO;QACb,WAAS;OACV;MACDC,IAAI,EAAE;QACJJ,IAAI,EAAEG,OAAO;QACb,WAAS;OACV;MACDE,cAAc,EAAE;QACdL,IAAI,EAAEM,MAAM;QACZ,WAAS;;EAEf;EACA;EACA;EACA;EACA;;KAEG;;IACDC,KAAK,EAAE,CAAC,WAAW,CAAC;;IAEpBC,QAAQ,qIAER;IACAC,QAAQ,EAAE;MACRC,WAAW,yBAAG;QACZ,IAAMC,MAAM,GAAG,CAAC,OAAO,EAAE,QAAQ,EAAE,MAAM,CAAC;QAC1C,IAAI,IAAI,CAACT,OAAO,EAAE;UAChBS,MAAM,CAACC,IAAI,CAAC,aAAa,CAAC;;QAE5B,OAAOD,MAAM;;KAEhB;IACDE,OAAO,EAAE;MACPC,WAAW,yBAAG;QACZ,IAAI,CAACC,KAAK,CAAC,WAAW,CAAC;OACxB;MACDC,gBAAgB,4BAACC,MAAM,EAAEC,QAAQ,EAAgB;QAAA,IAAdC,OAAO,uEAAG,EAAE;QAC7C,sBAMIA,OAAO,CALTC,MAAM;UAANA,MAAM,gCAAG,GAAG;UAAA,gBAKVD,OAAO,CAJTE,IAAI;UAAJA,IAAI,8BAAG,IAAI;UAAA,qBAITF,OAAO,CAHTG,SAAS;UAATA,SAAS,mCAAG,MAAM;UAAA,qBAGhBH,OAAO,CAFTI,SAAS;UAATA,SAAS,mCAAG,CAAC;UAAA,gBAEXJ,OAAO,CADTK,IAAI;UAAJA,IAAI,8BAAG,IAAI;QAGb,IAAI,EAAEP,MAAM,YAAYQ,OAAO,CAAC,EAAE;UAChC,MAAM,IAAIC,KAAK,CAAC,oDAAoD,CAAC;;QAEvE,IAAI,OAAOR,QAAQ,KAAK,UAAU,EAAE;UAClC,MAAM,IAAIQ,KAAK,CAAC,iDAAiD,CAAC;;QAGpE,IAAMC,GAAG,GAAIL,SAAS,KAAK,IAAI,IAAIA,SAAS,KAAK,MAAM,GAAIF,MAAM,GAAG,CAAC;QACrE,IAAMQ,MAAM,GAAIN,SAAS,KAAK,MAAM,IAAIA,SAAS,KAAK,MAAM,GAAIF,MAAM,GAAG,CAAC;QAE1E,IAAMS,QAAQ,GAAG,IAAIC,oBAAoB,CAAC,UAACC,OAAO,EAAK;UAAA,2CACjCA,OAAO;YAAA;UAAA;YAA3B,oDAA6B;cAAA,IAAlBC,KAAK;cACd,IAAIA,KAAK,CAACC,cAAc,EAAE;gBACxBf,QAAQ,CAACc,KAAK,CAAC;gBACf,IAAIR,IAAI,EAAEK,QAAQ,CAACK,SAAS,CAACjB,MAAM,CAAC;;;;YAEvC;;YAAA;;SACF,EAAE;UACDI,IAAI,EAAJA,IAAI;UACJc,UAAU,YAAKR,GAAG,oBAAUC,MAAM,WAAQ;UAC1CL,SAAS,EAATA;SACD,CAAC;QAEFM,QAAQ,CAACO,OAAO,CAACnB,MAAM,CAAC;QACxB,OAAO;UAAA,OAAMY,QAAQ,CAACK,SAAS,CAACjB,MAAM,CAAC;;;KAE1C;IACDoB,OAAO,qBAAG;MACR,IAAI,IAAI,CAAChC,cAAc,EAAE;QACvB,IAAI,CAACW,gBAAgB,CACnB,IAAI,CAACsB,KAAK,CAACC,UAAU,CAACC,GAAG,EACzB,IAAI,CAAC1B,WAAW,EAChB,IAAI,CAACT,cAAc,CACpB;;;EAGP,CAAC;;;;;;;;"}