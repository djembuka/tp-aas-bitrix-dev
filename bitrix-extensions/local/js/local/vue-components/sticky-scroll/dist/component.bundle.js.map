{"version":3,"file":"component.bundle.js","sources":["../src/component.js"],"sourcesContent":["import './component.css';\n\nexport const StickyScroll = {\n  data() {\n    return {\n      visible: true,\n      mousemove: false,\n      clickThumbStep: 100,\n      hoverSpaceStep: 10,\n      hoverSpaceInterval: 30,\n      hoverSpaceIntervalId: undefined,\n      thumbClickedFlag: false,\n      thumbClickedCoords: 0,\n      resizeTimeoutId: undefined,\n    };\n  },\n  props: ['reInitWatcher'],\n  template: `\n    <div class=\"twpx-sticky-scroll\" :class=\"{'twpx-sticky-scroll--invisible': !visible, 'twpx-sticky-scroll--mousemove': mousemove}\">\n      <div class=\"twpx-sticky-scroll-space-right\" ref=\"spaceRight\" @mouseover=\"spaceAndArrowMouseover('right')\" @mouseout=\"spaceAndArrowMouseout\"></div>\n      <div class=\"twpx-sticky-scroll-space-left\" ref=\"spaceLeft\" @mouseover=\"spaceAndArrowMouseover('left')\" @mouseout=\"spaceAndArrowMouseout\"></div>\n\n      <div class=\"twpx-sticky-scroll-arrows\">\n        <div class=\"twpx-sticky-scroll-arrow-right\" ref=\"arrowRight\" @mouseover=\"spaceAndArrowMouseover('right')\" @mouseout=\"spaceAndArrowMouseout\"></div>\n        <div class=\"twpx-sticky-scroll-arrow-left\" ref=\"arrowLeft\" @mouseover=\"spaceAndArrowMouseover('left')\" @mouseout=\"spaceAndArrowMouseout\"></div>\n      </div>\n\n      <div class=\"twpx-sticky-scroll-content-wrapper\" ref=\"contentWrapper\">\n        <div ref=\"content\">\n          <slot></slot>\n        </div>\n      </div>\n\n      <div class=\"twpx-sticky-scroll-scrollbar\" ref=\"scrollbar\" @click=\"scrollbarClick($event)\">\n        <div class=\"twpx-sticky-scroll-scrollbar-thumb\" ref=\"thumb\" @mousedown=\"thumbMousedown($event)\" @click=\"thumbClick($event)\"></div>\n      </div>\n    </div>\n  `,\n  watch: {\n    reInitWatcher(newVal, oldVal) {\n      if (newVal !== oldVal) {\n        this.setContentWidth();\n      }\n    },\n  },\n  methods: {\n    init() {\n      if (window.matchMedia('(min-width: 768px)').matches) {\n        this.setThumbWidth();\n      } else {\n        this.visible = false;\n      }\n    },\n    setThumbWidth() {\n      const ratio =\n        this.$refs.contentWrapper.clientWidth / this.$refs.content.clientWidth;\n\n      this.visible = ratio < 1;\n\n      if (this.visible) {\n        setTimeout(() => {\n          this.$refs.thumb.style.width = `${\n            this.$refs.scrollbar.clientWidth * ratio\n          }px`;\n\n          this.setDelta();\n        }, 0);\n      }\n    },\n    setDelta() {\n      this.scrollbarDelta =\n        this.$refs.scrollbar.clientWidth - this.$refs.thumb.clientWidth;\n      this.contentDelta =\n        this.$refs.content.clientWidth - this.$refs.contentWrapper.clientWidth;\n    },\n    thumbMousedown(e) {\n      this.thumbClickedFlag = true;\n      this.thumbClickedCoords =\n        e.clientX - this.$refs.thumb.getBoundingClientRect().x;\n    },\n    thumbClick(e) {\n      e.stopPropagation();\n    },\n    scrollbarClick(e) {\n      e.preventDefault();\n\n      const scrollbarX = this.$refs.scrollbar.getBoundingClientRect().x;\n      const thumbX = this.$refs.thumb.getBoundingClientRect().x;\n      let step = this.clickThumbStep;\n\n      if (e.clientX - thumbX < 0) {\n        step = -1 * this.clickThumbStep;\n      }\n\n      let left = thumbX - scrollbarX + step;\n      this.moveThumbAndContent(left);\n    },\n    spaceAndArrowMouseover(type) {\n      let step = this.hoverSpaceStep;\n      if (type === 'left') {\n        step = -1 * this.hoverSpaceStep;\n      }\n      this.hoverSpaceIntervalId = setInterval(() => {\n        let left = this.$refs.contentWrapper.scrollLeft + step;\n        this.moveContentAndThumb(left);\n      }, this.hoverSpaceInterval);\n    },\n    spaceAndArrowMouseout() {\n      clearInterval(this.hoverSpaceIntervalId);\n    },\n    moveThumbAndContent(left) {\n      if (left > this.scrollbarDelta) {\n        left = this.scrollbarDelta;\n      } else if (left < 0) {\n        left = 0;\n      }\n\n      this.$refs.thumb.style.left = `${left}px`;\n\n      //move content\n      let contentDelta;\n\n      if (left === this.scrollbarDelta) {\n        contentDelta = this.contentDelta;\n      } else if (left === 0) {\n        contentDelta = 0;\n        left = 0;\n      } else {\n        contentDelta = (left / this.scrollbarDelta) * this.contentDelta;\n      }\n\n      this.$refs.contentWrapper.scrollTo(contentDelta, 0);\n    },\n    moveContentAndThumb(left) {\n      if (left > this.contentDelta) {\n        left = this.contentDelta;\n        clearInterval(this.hoverSpaceIntervalId);\n      } else if (left < 0) {\n        left = 0;\n        clearInterval(this.hoverSpaceIntervalId);\n      }\n\n      this.$refs.contentWrapper.scrollTo(left, 0);\n\n      //move content\n      let scrollDelta;\n\n      if (left === this.contentDelta) {\n        scrollDelta = this.scrollbarDelta;\n      } else if (left === 0) {\n        scrollDelta = 0;\n        left = 0;\n      } else {\n        scrollDelta = (left / this.contentDelta) * this.scrollbarDelta;\n      }\n\n      this.$refs.thumb.style.left = `${scrollDelta}px`;\n    },\n    setContentWidth() {\n      this.$refs.content.style.width = 'auto';\n\n      if (this.resizeTimeoutId) {\n        clearInterval(this.resizeTimeoutId);\n      }\n\n      this.resizeTimeoutId = setTimeout(() => {\n        if (this.$refs.content) {\n          if (this.$refs.content.querySelector('table.table')) {\n            this.$refs.content.style.width = `${\n              this.$refs.content.querySelector('table.table').clientWidth\n            }px`;\n          } else if (this.$refs.content.firstElementChild) {\n            this.$refs.content.style.width = `${this.$refs.content.firstElementChild.clientWidth}px`;\n          }\n\n          setTimeout(() => {\n            this.init();\n          }, 0);\n        }\n      }, 200);\n    },\n    async initContentWidth() {\n      do {\n        if (\n          !this.$refs.content ||\n          (!this.$refs.content.querySelector('table.table') &&\n            !this.$refs.content.firstElementChild)\n        ) {\n          await new Promise((r) => setTimeout(r, 500));\n        } else {\n          this.setContentWidth();\n          break;\n        }\n      } while (true);\n    },\n  },\n  mounted() {\n    window.addEventListener('resize', () => {\n      this.setContentWidth();\n    });\n\n    this.initContentWidth();\n\n    //document mouseup\n    document.addEventListener('mouseup', () => {\n      if (this.thumbClickedFlag) {\n        this.thumbClickedFlag = false;\n      }\n    });\n\n    //document mousemove\n    document.addEventListener('mousemove', (e) => {\n      if (this.thumbClickedFlag) {\n        e.preventDefault();\n        let left =\n          e.clientX -\n          this.$refs.scrollbar.getBoundingClientRect().x -\n          this.thumbClickedCoords;\n\n        this.moveThumbAndContent(left);\n      }\n    });\n  },\n};\n"],"names":["StickyScroll","data","visible","mousemove","clickThumbStep","hoverSpaceStep","hoverSpaceInterval","hoverSpaceIntervalId","undefined","thumbClickedFlag","thumbClickedCoords","resizeTimeoutId","props","template","watch","reInitWatcher","newVal","oldVal","setContentWidth","methods","init","window","matchMedia","matches","setThumbWidth","ratio","$refs","contentWrapper","clientWidth","content","setTimeout","thumb","style","width","scrollbar","setDelta","scrollbarDelta","contentDelta","thumbMousedown","e","clientX","getBoundingClientRect","x","thumbClick","stopPropagation","scrollbarClick","preventDefault","scrollbarX","thumbX","step","left","moveThumbAndContent","spaceAndArrowMouseover","type","setInterval","scrollLeft","moveContentAndThumb","spaceAndArrowMouseout","clearInterval","scrollTo","scrollDelta","querySelector","firstElementChild","initContentWidth","Promise","r","mounted","addEventListener","document"],"mappings":"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"}