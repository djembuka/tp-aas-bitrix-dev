{"version":3,"file":"component.bundle.js","sources":["../src/component.js"],"sourcesContent":["import './component.css';\r\n\r\nexport const StickyScroll = {\r\n  data() {\r\n    return {\r\n      visible: true,\r\n      mousemove: false,\r\n      clickThumbStep: 100,\r\n      hoverSpaceStep: 10,\r\n      hoverSpaceInterval: 30,\r\n      hoverSpaceIntervalId: undefined,\r\n      thumbClickedFlag: false,\r\n      thumbClickedCoords: 0,\r\n      resizeTimeoutId: undefined,\r\n    };\r\n  },\r\n  props: ['reInitWatcher'],\r\n  template: `\r\n    <div class=\"twpx-sticky-scroll\" :class=\"{'twpx-sticky-scroll--invisible': !visible, 'twpx-sticky-scroll--mousemove': mousemove}\">\r\n      <div class=\"twpx-sticky-scroll-space-right\" ref=\"spaceRight\" @mouseover=\"spaceAndArrowMouseover('right')\" @mouseout=\"spaceAndArrowMouseout\"></div>\r\n      <div class=\"twpx-sticky-scroll-space-left\" ref=\"spaceLeft\" @mouseover=\"spaceAndArrowMouseover('left')\" @mouseout=\"spaceAndArrowMouseout\"></div>\r\n\r\n      <div class=\"twpx-sticky-scroll-arrows\">\r\n        <div class=\"twpx-sticky-scroll-arrow-right\" ref=\"arrowRight\" @mouseover=\"spaceAndArrowMouseover('right')\" @mouseout=\"spaceAndArrowMouseout\"></div>\r\n        <div class=\"twpx-sticky-scroll-arrow-left\" ref=\"arrowLeft\" @mouseover=\"spaceAndArrowMouseover('left')\" @mouseout=\"spaceAndArrowMouseout\"></div>\r\n      </div>\r\n\r\n      <div class=\"twpx-sticky-scroll-content-wrapper\" ref=\"contentWrapper\">\r\n        <div ref=\"content\">\r\n          <slot></slot>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"twpx-sticky-scroll-scrollbar\" ref=\"scrollbar\" @click=\"scrollbarClick($event)\">\r\n        <div class=\"twpx-sticky-scroll-scrollbar-thumb\" ref=\"thumb\" @mousedown=\"thumbMousedown($event)\" @click=\"thumbClick($event)\"></div>\r\n      </div>\r\n    </div>\r\n  `,\r\n  watch: {\r\n    reInitWatcher(newVal, oldVal) {\r\n      if (newVal !== oldVal) {\r\n        this.setContentWidth();\r\n      }\r\n    },\r\n  },\r\n  methods: {\r\n    init() {\r\n      if (window.matchMedia('(min-width: 768px)').matches) {\r\n        this.setThumbWidth();\r\n      } else {\r\n        this.visible = false;\r\n      }\r\n    },\r\n    setThumbWidth() {\r\n      const ratio =\r\n        this.$refs.contentWrapper.clientWidth / this.$refs.content.clientWidth;\r\n\r\n      this.visible = ratio < 1;\r\n\r\n      if (this.visible) {\r\n        setTimeout(() => {\r\n          this.$refs.thumb.style.width = `${\r\n            this.$refs.scrollbar.clientWidth * ratio\r\n          }px`;\r\n\r\n          this.setDelta();\r\n        }, 0);\r\n      }\r\n    },\r\n    setDelta() {\r\n      this.scrollbarDelta =\r\n        this.$refs.scrollbar.clientWidth - this.$refs.thumb.clientWidth;\r\n      this.contentDelta =\r\n        this.$refs.content.clientWidth - this.$refs.contentWrapper.clientWidth;\r\n    },\r\n    thumbMousedown(e) {\r\n      this.thumbClickedFlag = true;\r\n      this.thumbClickedCoords =\r\n        e.clientX - this.$refs.thumb.getBoundingClientRect().x;\r\n    },\r\n    thumbClick(e) {\r\n      e.stopPropagation();\r\n    },\r\n    scrollbarClick(e) {\r\n      e.preventDefault();\r\n\r\n      const scrollbarX = this.$refs.scrollbar.getBoundingClientRect().x;\r\n      const thumbX = this.$refs.thumb.getBoundingClientRect().x;\r\n      let step = this.clickThumbStep;\r\n\r\n      if (e.clientX - thumbX < 0) {\r\n        step = -1 * this.clickThumbStep;\r\n      }\r\n\r\n      let left = thumbX - scrollbarX + step;\r\n      this.moveThumbAndContent(left);\r\n    },\r\n    spaceAndArrowMouseover(type) {\r\n      let step = this.hoverSpaceStep;\r\n      if (type === 'left') {\r\n        step = -1 * this.hoverSpaceStep;\r\n      }\r\n      this.hoverSpaceIntervalId = setInterval(() => {\r\n        let left = this.$refs.contentWrapper.scrollLeft + step;\r\n        this.moveContentAndThumb(left);\r\n      }, this.hoverSpaceInterval);\r\n    },\r\n    spaceAndArrowMouseout() {\r\n      clearInterval(this.hoverSpaceIntervalId);\r\n    },\r\n    moveThumbAndContent(left) {\r\n      if (left > this.scrollbarDelta) {\r\n        left = this.scrollbarDelta;\r\n      } else if (left < 0) {\r\n        left = 0;\r\n      }\r\n\r\n      this.$refs.thumb.style.left = `${left}px`;\r\n\r\n      //move content\r\n      let contentDelta;\r\n\r\n      if (left === this.scrollbarDelta) {\r\n        contentDelta = this.contentDelta;\r\n      } else if (left === 0) {\r\n        contentDelta = 0;\r\n        left = 0;\r\n      } else {\r\n        contentDelta = (left / this.scrollbarDelta) * this.contentDelta;\r\n      }\r\n\r\n      this.$refs.contentWrapper.scrollTo(contentDelta, 0);\r\n    },\r\n    moveContentAndThumb(left) {\r\n      if (left > this.contentDelta) {\r\n        left = this.contentDelta;\r\n        clearInterval(this.hoverSpaceIntervalId);\r\n      } else if (left < 0) {\r\n        left = 0;\r\n        clearInterval(this.hoverSpaceIntervalId);\r\n      }\r\n\r\n      this.$refs.contentWrapper.scrollTo(left, 0);\r\n\r\n      //move content\r\n      let scrollDelta;\r\n\r\n      if (left === this.contentDelta) {\r\n        scrollDelta = this.scrollbarDelta;\r\n      } else if (left === 0) {\r\n        scrollDelta = 0;\r\n        left = 0;\r\n      } else {\r\n        scrollDelta = (left / this.contentDelta) * this.scrollbarDelta;\r\n      }\r\n\r\n      this.$refs.thumb.style.left = `${scrollDelta}px`;\r\n    },\r\n    setContentWidth() {\r\n      this.$refs.content.style.width = 'auto';\r\n\r\n      if (this.resizeTimeoutId) {\r\n        clearInterval(this.resizeTimeoutId);\r\n      }\r\n\r\n      this.resizeTimeoutId = setTimeout(() => {\r\n        if (this.$refs.content) {\r\n          if (this.$refs.content.querySelector('table.table')) {\r\n            this.$refs.content.style.width = `${\r\n              this.$refs.content.querySelector('table.table').clientWidth\r\n            }px`;\r\n          } else if (this.$refs.content.firstElementChild) {\r\n            this.$refs.content.style.width = `${this.$refs.content.firstElementChild.clientWidth}px`;\r\n          }\r\n\r\n          setTimeout(() => {\r\n            this.init();\r\n          }, 0);\r\n        }\r\n      }, 200);\r\n    },\r\n    async initContentWidth() {\r\n      do {\r\n        if (\r\n          !this.$refs.content ||\r\n          (!this.$refs.content.querySelector('table.table') &&\r\n            !this.$refs.content.firstElementChild)\r\n        ) {\r\n          await new Promise((r) => setTimeout(r, 500));\r\n        } else {\r\n          this.setContentWidth();\r\n          break;\r\n        }\r\n      } while (true);\r\n    },\r\n  },\r\n  mounted() {\r\n    window.addEventListener('resize', () => {\r\n      this.setContentWidth();\r\n    });\r\n\r\n    this.initContentWidth();\r\n\r\n    //document mouseup\r\n    document.addEventListener('mouseup', () => {\r\n      if (this.thumbClickedFlag) {\r\n        this.thumbClickedFlag = false;\r\n      }\r\n    });\r\n\r\n    //document mousemove\r\n    document.addEventListener('mousemove', (e) => {\r\n      if (this.thumbClickedFlag) {\r\n        e.preventDefault();\r\n        let left =\r\n          e.clientX -\r\n          this.$refs.scrollbar.getBoundingClientRect().x -\r\n          this.thumbClickedCoords;\r\n\r\n        this.moveThumbAndContent(left);\r\n      }\r\n    });\r\n  },\r\n};\r\n"],"names":["StickyScroll","data","visible","mousemove","clickThumbStep","hoverSpaceStep","hoverSpaceInterval","hoverSpaceIntervalId","undefined","thumbClickedFlag","thumbClickedCoords","resizeTimeoutId","props","template","watch","reInitWatcher","newVal","oldVal","setContentWidth","methods","init","window","matchMedia","matches","setThumbWidth","ratio","$refs","contentWrapper","clientWidth","content","setTimeout","thumb","style","width","scrollbar","setDelta","scrollbarDelta","contentDelta","thumbMousedown","e","clientX","getBoundingClientRect","x","thumbClick","stopPropagation","scrollbarClick","preventDefault","scrollbarX","thumbX","step","left","moveThumbAndContent","spaceAndArrowMouseover","type","setInterval","scrollLeft","moveContentAndThumb","spaceAndArrowMouseout","clearInterval","scrollTo","scrollDelta","querySelector","firstElementChild","initContentWidth","Promise","r","mounted","addEventListener","document"],"mappings":"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"}