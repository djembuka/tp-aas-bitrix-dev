{"version":3,"file":"application.bundle.js","sources":["../src/stores/form.js","../src/components/application.js","../src/stores/data.js","../src/loader.js"],"sourcesContent":["import { defineStore } from 'ui.vue3.pinia';\r\n\r\nexport const formStore = defineStore('form', {\r\n  state: () => ({\r\n    loadingControls: false,\r\n    actions: {},\r\n    controls: [],\r\n  }),\r\n  actions: {\r\n    runControls(data, callback) {\r\n      this.loadingControls = true;\r\n      let a = window.BX.ajax.runComponentAction(this.actions.controls, data);\r\n      let state = this;\r\n\r\n      a.then(\r\n        (result) => {\r\n          this.loadingControls = false;\r\n          resultFn(state, result);\r\n        },\r\n        (error) => {\r\n          this.loadingControls = false;\r\n          if (\r\n            window.twinpx &&\r\n            window.twinpx.vue.markup &&\r\n            window.twinpx.vue['form-with-multi']\r\n          ) {\r\n            resultFn(state, window.twinpx.vue['form-with-multi'].controls);\r\n          } else {\r\n            // this.showError({ error, method: 'controls' });\r\n          }\r\n        }\r\n      );\r\n\r\n      function resultFn(state, data) {\r\n        state.controls = data;\r\n        if (callback) {\r\n          callback();\r\n        }\r\n      }\r\n    },\r\n  },\r\n});\r\n","import './application.css';\r\n\r\nimport { Control } from 'local.vue-components.control';\r\n\r\nimport { mapState, mapActions } from 'ui.vue3.pinia';\r\nimport { formStore } from '../stores/form';\r\n\r\nexport const Application = {\r\n  data() {\r\n    return {};\r\n  },\r\n  components: {\r\n    Control,\r\n  },\r\n  // language=Vue\r\n\r\n  template: `\r\n    <div>\r\n      <pre>{{controls}}</pre>\r\n      <Control v-for=\"control in controls\" :key=\"control.id\" :control=\"control\" @input=\"input\" @hints=\"hints\"></Control>\r\n    </div>\r\n\t`,\r\n  computed: {\r\n    ...mapState(formStore, ['loadingControls', 'controls']),\r\n    // error() {\r\n    //   return this.errorTable || this.errorFilter;\r\n    // },\r\n  },\r\n  methods: {\r\n    ...mapActions(formStore, ['runControls']),\r\n    input({ control, value, checked }) {\r\n      this.changeControlValue({\r\n        control,\r\n        value,\r\n        checked,\r\n      });\r\n    },\r\n  },\r\n  mounted() {\r\n    this.runControls({\r\n      signedParameters: this.signedParameters,\r\n      sessionid: this.sessionid,\r\n    });\r\n  },\r\n};\r\n","import { defineStore } from 'ui.vue3.pinia';\r\n\r\nexport const dataStore = defineStore('data', {\r\n  state: () => ({\r\n    sessionid: '',\r\n    signedParameters: '',\r\n  }),\r\n});\r\n","import { BitrixVue } from 'ui.vue3';\r\nimport { Application } from './components/application';\r\nimport { createPinia, setActivePinia } from 'ui.vue3.pinia';\r\nimport { dataStore } from './stores/data';\r\nimport { formStore } from './stores/form';\r\n\r\nexport class FormWithMulti {\r\n  #store;\r\n  #rootNode;\r\n  #application;\r\n\r\n  constructor(rootNode, options): void {\r\n    this.#store = createPinia();\r\n    this.#rootNode = document.querySelector(rootNode);\r\n    this.options = options;\r\n  }\r\n\r\n  run(): void {\r\n    const self = this;\r\n\r\n    this.#application = BitrixVue.createApp({\r\n      name: 'Form with multi control Application',\r\n      components: {\r\n        Application,\r\n      },\r\n      template: '<Application/>',\r\n      mounted() {\r\n        dataStore().sessionid = self.options.SESSION_ID || '';\r\n        dataStore().signedParameters = self.options.SIGNED_PARAMETERS || '';\r\n\r\n        formStore().actions = {\r\n          controls: self.options.controls || [],\r\n        };\r\n      },\r\n    });\r\n\r\n    this.#application.use(this.#store);\r\n    this.#application.mount(this.#rootNode);\r\n  }\r\n\r\n  initStorageBeforeStartApplication(): void {\r\n    setActivePinia(this.#store);\r\n  }\r\n\r\n  getFormStore(): Object {\r\n    return formStore;\r\n  }\r\n}\r\n"],"names":["formStore","defineStore","state","loadingControls","actions","controls","runControls","data","callback","a","window","BX","ajax","runComponentAction","then","result","resultFn","error","twinpx","vue","markup","Application","components","Control","template","computed","mapState","methods","mapActions","input","control","value","checked","changeControlValue","mounted","signedParameters","sessionid","dataStore","FormWithMulti","rootNode","options","createPinia","document","querySelector","self","BitrixVue","createApp","name","SESSION_ID","SIGNED_PARAMETERS","use","mount","setActivePinia"],"mappings":"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"}