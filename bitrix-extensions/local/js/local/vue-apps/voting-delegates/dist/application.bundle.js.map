{"version":3,"file":"application.bundle.js","sources":["../src/stores/data.js","../src/components/application.js","../src/loader.js"],"sourcesContent":["import { defineStore } from 'ui.vue3.pinia';\r\n\r\nexport const dataStore = defineStore('data', {\r\n  state: () => ({\r\n    command: '',\r\n    params: {},\r\n    extra: {}\r\n\r\n  }),\r\n  actions: {\r\n    changeProp(prop, value) {\r\n      this[prop] = value;\r\n    }\r\n  }\r\n});\r\n","import './application.css';\r\n\r\nimport { mapState, mapActions } from 'ui.vue3.pinia';\r\nimport { dataStore } from '../stores/data.js';\r\n\r\nexport const Application = {\r\n    template: `\r\n      <div class=\"twpx-voting-client__header\">\r\n          <img width=\"62\" height=\"54\" alt=\"Саморегулируемая организация аудиторов Ассоциация «Содружество»\" src=\"/local/templates/aas/images/logo-aas-small.svg\">\r\n      </div>\r\n\r\n      <div class=\"twpx-voting-members twpx-voting-client-block\">\r\n\r\n        <div class=\"twpx-voting-members-content\">\r\n\r\n          <h1>Съезд СРО ААС 2025</h1>\r\n\r\n          <div class=\"twpx-voting-members-grid\">\r\n            <div class=\"twpx-voting-members-column\">\r\n              <div class=\"twpx-voting-members-column-header\">\r\n                <h2>Зарегистрировались</h2>\r\n                <div class=\"twpx-voting-members-counter\">\r\n                  <div class=\"twpx-voting-members-num\">{{ registeredNum }}</div>\r\n                  <div class=\"twpx-voting-members-percent\">{{ registeredPercent }}%</div>\r\n                </div>\r\n              </div>\r\n              <div class=\"twpx-voting-members-list\">\r\n                <div v-for=\"delegate in params.registered\" :key=\"delegate\">{{ delegate }}</div>\r\n              </div>\r\n            </div>\r\n            <div class=\"twpx-voting-members-column\">\r\n              <div class=\"twpx-voting-members-column-header\">\r\n                <h2>Не зарегистрировались</h2>\r\n                <div class=\"twpx-voting-members-counter\">\r\n                  <div class=\"twpx-voting-members-num\">{{ notRegisteredNum }}</div>\r\n                  <div class=\"twpx-voting-members-percent\">{{ notRegisteredPercent }}%</div>\r\n                </div>\r\n              </div>\r\n              <div class=\"twpx-voting-members-list\">\r\n                <div v-for=\"delegate in params.notRegistered\" :key=\"delegate\">{{ delegate }}</div>\r\n              </div>\r\n          </div>\r\n\r\n        </div>\r\n\r\n      </div>\r\n    `,\r\n    computed: {\r\n        ...mapState(dataStore, [\r\n          'command',\r\n          'params',\r\n          'extra',\r\n        ]),\r\n        registeredNum() {\r\n          return this.params?.registered?.length || 0;\r\n        },\r\n        notRegisteredNum() {\r\n          return this.params?.notRegistered?.length || 0;\r\n        },\r\n        registeredPercent() {\r\n          const total = this.registeredNum + this.notRegisteredNum;\r\n          return total ? Math.round(this.registeredNum * 100 / total) : 0;\r\n        },\r\n        notRegisteredPercent() {\r\n          const total = this.registeredNum + this.notRegisteredNum;\r\n          return total ? Math.round(this.notRegisteredNum * 100 / total) : 0;\r\n        },\r\n    },\r\n    methods: {\r\n        ...mapActions(dataStore, [\r\n          'changeProp',\r\n        ]),\r\n        subscribe() {\r\n            const _this = this;\r\n\r\n            if (window.BX && BX.ready) {\r\n              BX.ready(function() {\r\n                BX.PULL.subscribe({\r\n                  moduleId: 'voting',\r\n                  callback: function(data) {\r\n\r\n                    if (data.command.startsWith('delegates')) {\r\n                      _this.changeProp('command', data.command);\r\n                      _this.changeProp('params', data.params);\r\n                      _this.changeProp('extra', data.extra);\r\n                    }\r\n      \r\n                    console.log('Command:', data.command)\r\n                    console.log('Params:', data.params)\r\n                    console.log('Extra:', data.extra)\r\n                  }.bind(this)\r\n                });\r\n                BX.PULL.extendWatch('VOTING-DELEGATES'); /* код голосование для уникальность */\r\n              });\r\n            }\r\n          }\r\n    },\r\n    mounted() {\r\n        this.subscribe();\r\n    }\r\n};","import { BitrixVue } from 'ui.vue3';\r\nimport { Application } from './components/application';\r\nimport { createPinia, setActivePinia } from 'ui.vue3.pinia';\r\n\r\nexport class VotingDelegates {\r\n  #store;\r\n  #rootNode;\r\n  #application;\r\n\r\n  constructor(rootNode, options) {\r\n    this.#store = createPinia();\r\n    this.#rootNode = document.querySelector(rootNode);\r\n    this.options = options;\r\n  }\r\n\r\n  run() {\r\n    this.#application = BitrixVue.createApp({\r\n      name: 'VotingScreen',\r\n      components: {\r\n        Application,\r\n      },\r\n      template: '<Application />',\r\n    });\r\n\r\n    this.#application.use(this.#store);\r\n    this.#application.mount(this.#rootNode);\r\n  }\r\n\r\n  initStorageBeforeStartApplication() {\r\n    setActivePinia(this.#store);\r\n  }\r\n\r\n  getFormStore() {\r\n    return formStore;\r\n  }\r\n}\r\n"],"names":["dataStore","defineStore","state","command","params","extra","actions","changeProp","prop","value","Application","template","computed","mapState","registeredNum","registered","length","notRegisteredNum","notRegistered","registeredPercent","total","Math","round","notRegisteredPercent","methods","mapActions","subscribe","_this","window","BX","ready","PULL","moduleId","callback","data","startsWith","console","log","bind","extendWatch","mounted","VotingDelegates","rootNode","options","createPinia","document","querySelector","BitrixVue","createApp","name","components","use","mount","setActivePinia","formStore"],"mappings":"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"}