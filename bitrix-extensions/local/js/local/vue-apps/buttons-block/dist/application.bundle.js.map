{"version":3,"file":"application.bundle.js","sources":["../src/stores/data.js","../src/stores/app.js","../src/components/button.js","../src/components/application.js","../src/loader.js"],"sourcesContent":["import { defineStore } from 'ui.vue3.pinia';\r\n\r\nexport const buttonsBlockDataStore = defineStore('buttons-block-data', {\r\n  state: () => ({\r\n    id: `id${Math.floor(Math.random() * 1000)}`,\r\n    data: {},\r\n    lang: {},\r\n    actions: []\r\n  }),\r\n});\r\n","import { defineStore } from 'ui.vue3.pinia';\r\nimport { buttonsBlockDataStore } from './data';\r\n\r\nexport const buttonsBlockAppStore = defineStore('buttons-block-app', {\r\n  state: () => ({\r\n    loading: false,\r\n    error: '',\r\n    stateWatcher: false,\r\n    modal: {}\r\n  }),\r\n  actions: {\r\n    changeModal(modal) {\r\n      this.modal = modal\r\n    },\r\n    changeStateWatcher() {\r\n      this.stateWatcher = !this.stateWatcher;\r\n    },\r\n    changeError(error) {\r\n      this.error = error;\r\n    },\r\n    runDelete(action) {\r\n      this.error = '';\r\n      this.loading = true;\r\n      const d = buttonsBlockDataStore();\r\n\r\n      this.loading = false;\r\n      return;\r\n\r\n      BX.ajax.runComponentAction(action[0], action[1], {\r\n        mode: 'class',\r\n        data: d.data,\r\n      })\r\n      .then((response) => {\r\n        this.loading = false;\r\n        if (response.status === 'success' && response.data.redirect) {\r\n          this.changeError('');\r\n          this.window.location = response.data.redirect;\r\n        } else {\r\n          this.changeError(response.errors[0].message);\r\n        }\r\n      },\r\n      (response) => {\r\n        this.loading = false;\r\n        if (response && response.errors.length) {\r\n          this.changeError(response.errors[0].message);\r\n        }\r\n      });\r\n    },\r\n  },\r\n});\r\n","import { ButtonComponent } from 'local.vue-components.button-component';\r\nimport { buttonsBlockAppStore } from '../stores/app';\r\nimport { mapState, mapActions } from 'ui.vue3.pinia';\r\n\r\nexport default {\r\n  data() {\r\n    return {};\r\n  },\r\n  props: ['button'],\r\n  components: {\r\n    ButtonComponent\r\n  },\r\n  // language=Vue\r\n  template: `<ButtonComponent :text=\"button.text\" :props=\"buttonProps()\" @clickButton=\"clickButton\" />`,\r\n  computed: {},\r\n  methods: {\r\n    ...mapActions(buttonsBlockAppStore, ['changeStateWatcher', 'changeModal', 'runDelete']),\r\n    buttonProps() {\r\n        let result = ['secondary', 'large'];\r\n\r\n        switch(this.button.type) {\r\n            case 'delete':\r\n                result = ['icon-delete', 'danger', 'large'];\r\n                break;\r\n        }\r\n        return result;\r\n    },\r\n    clickButton() {\r\n        if (this.button.type === 'delete') {\r\n            const clickYes = () => {\r\n                this.runDelete(this.button.actions['delete']);\r\n                this.changeStateWatcher();\r\n            };\r\n            const clickNo = () => {\r\n                this.changeStateWatcher();\r\n            };\r\n            const buttons = {\r\n                yes: {\r\n                    props: ['danger', 'large']\r\n                },\r\n                no: {\r\n                    props: ['gray-color', 'large']\r\n                }\r\n            };\r\n            this.changeModal({...this.button.modal, clickYes, clickNo, buttons});\r\n            this.changeStateWatcher();\r\n        }\r\n    }\r\n  },\r\n};\r\n","import './application.css';\r\n\r\nimport ButtonItem from './button.js';\r\nimport { LoaderCircle } from 'local.vue-components.loader-circle';\r\nimport { MessageComponent } from 'local.vue-components.message-component';\r\nimport { ModalYesNo } from 'local.vue-components.modal-yes-no';\r\n\r\nimport { mapState, mapActions } from 'ui.vue3.pinia';\r\nimport { buttonsBlockDataStore } from '../stores/data.js';\r\nimport { buttonsBlockAppStore } from '../stores/app.js';\r\n\r\nexport const Application = {\r\n  data() {\r\n    return {};\r\n  },\r\n  components: {\r\n    ButtonItem,\r\n    LoaderCircle,\r\n    MessageComponent,\r\n    ModalYesNo\r\n  },\r\n  // language=Vue\r\n  template: `\r\n  <div class=\"twpx-buttons-block\" :id=\"id\">\r\n\r\n    <LoaderCircle :show=\"loading\" />\r\n\r\n    <MessageComponent v-if=\"error\" type=\"error\" size=\"big\" :message=\"error\" />\r\n\r\n    <ModalYesNo\r\n      :heading=\"modal.heading\"\r\n      :text=\"modal.text\"\r\n      :yes=\"modal.yes\"\r\n      :no=\"modal.no\"\r\n      :buttons=\"modal.buttons\"\r\n      :stateWatcher=\"stateWatcher\"\r\n      @clickYes=\"modal.clickYes\"\r\n      @clickNo=\"modal.clickNo\"\r\n    />\r\n\r\n    <div class=\"twpx-buttons-block__wrapper\">\r\n\r\n      <h3>{{ lang.heading }}</h3>\r\n      <div v-html=\"lang.text\"></div>\r\n      <div class=\"twpx-buttons-block__buttons\">\r\n        <ButtonItem v-for=\"button in buttons\" :key=\"Math.floor(Math.random()*100)\" :button=\"button\" />\r\n      </div>\r\n\r\n    </div>\r\n  </div>\r\n\t`,\r\n  computed: {\r\n    ...mapState(buttonsBlockDataStore, ['lang', 'id']),\r\n    ...mapState(buttonsBlockAppStore, ['loading', 'error', 'stateWatcher', 'modal', 'buttons'])\r\n  },\r\n  methods: {\r\n    ...mapActions(buttonsBlockAppStore, ['runGetForm']),\r\n    clickYes() {\r\n      this.runSaveForm();\r\n      this.changeStateWatcher();\r\n    },\r\n    clickNo() {\r\n      this.changeStateWatcher();\r\n    }\r\n  },\r\n};\r\n","import { BitrixVue } from 'ui.vue3';\r\nimport { Application } from './components/application';\r\nimport { createPinia, setActivePinia } from 'ui.vue3.pinia';\r\nimport { buttonsBlockDataStore } from './stores/data';\r\nimport { buttonsBlockAppStore } from './stores/app';\r\n\r\nexport class ButtonsBlock {\r\n  #store;\r\n  #rootNode;\r\n  #application;\r\n\r\n  constructor(rootNode, options): void {\r\n    this.#store = createPinia();\r\n    this.#rootNode = document.querySelector(rootNode);\r\n    this.options = options;\r\n  }\r\n\r\n  run(): void {\r\n    const self = this;\r\n\r\n    this.#application = BitrixVue.createApp({\r\n      name: 'DisciplinaryCaseForm',\r\n      components: {\r\n        Application,\r\n      },\r\n      template: '<Application/>',\r\n      beforeMount() {\r\n        buttonsBlockDataStore().data = self.options.data || {};\r\n        buttonsBlockDataStore().lang = self.options.lang || {};\r\n\r\n        buttonsBlockAppStore().buttons = self.options.buttons || [];\r\n      },\r\n      mounted() {},\r\n    });\r\n\r\n    this.#application.use(this.#store);\r\n    this.#application.mount(this.#rootNode);\r\n  }\r\n\r\n  initStorageBeforeStartApplication(): void {\r\n    setActivePinia(this.#store);\r\n  }\r\n\r\n  getFormStore(): Object {\r\n    return formStore;\r\n  }\r\n}\r\n"],"names":["buttonsBlockDataStore","defineStore","state","id","Math","floor","random","data","lang","actions","buttonsBlockAppStore","loading","error","stateWatcher","modal","changeModal","changeStateWatcher","changeError","runDelete","action","d","BX","ajax","runComponentAction","mode","then","response","status","redirect","window","location","errors","message","length","props","components","ButtonComponent","template","computed","methods","mapActions","buttonProps","result","button","type","clickButton","clickYes","clickNo","buttons","yes","no","Application","ButtonItem","LoaderCircle","MessageComponent","ModalYesNo","mapState","runSaveForm","ButtonsBlock","rootNode","options","createPinia","document","querySelector","self","BitrixVue","createApp","name","beforeMount","mounted","use","mount","setActivePinia","formStore"],"mappings":"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"}